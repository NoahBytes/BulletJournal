#  Template python-build

#  This template allows you to validate your python code.
#  The workflow allows running tests and code linting on the default branch.

image: python:3.8

pipelines:
  default:
    - step:
        name: Install Dependencies and Run Tests
        caches:
          - pip
        script:
          - echo "Installing dependencies..."
          - pip install -r requirements.txt
    - step:
        name: Deploy to Firebase
        deployment: production
        # trigger: manual  # Uncomment to make this a manual deployment.
        script:
          - echo "Deploying to production environment"
          - echo "OPENAI_API_KEY=$OPENAI_API_KEY" > .env
          - pip install -r requirements.txt
          - python runserver.py
